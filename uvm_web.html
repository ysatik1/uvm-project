<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–£—á–µ–±–Ω–∞—è –í–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –ú–∞—à–∏–Ω–∞ (Web)</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 25px;
            text-align: center;
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            padding: 20px;
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }

        .panel {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .panel-header {
            background: #3498db;
            color: white;
            padding: 15px;
            border-radius: 8px 8px 0 0;
            margin: -20px -20px 20px -20px;
            font-weight: bold;
        }

        textarea {
            width: 100%;
            height: 300px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            resize: vertical;
            margin-bottom: 15px;
            background: #fff;
            color: #333;
        }

        textarea:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }

        .controls {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }

        button {
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-run {
            background: #2ecc71;
            color: white;
        }

        .btn-run:hover {
            background: #27ae60;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(46, 204, 113, 0.3);
        }

        .btn-clear {
            background: #e74c3c;
            color: white;
        }

        .btn-clear:hover {
            background: #c0392b;
            transform: translateY(-2px);
        }

        .btn-example {
            background: #f39c12;
            color: white;
        }

        .btn-example:hover {
            background: #d35400;
            transform: translateY(-2px);
        }

        .memory-range {
            display: flex;
            gap: 10px;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .memory-range input {
            padding: 8px 12px;
            border: 2px solid #ddd;
            border-radius: 6px;
            width: 80px;
            text-align: center;
        }

        .output {
            background: #1a1a1a;
            color: #00ff00;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            padding: 15px;
            border-radius: 8px;
            height: 400px;
            overflow-y: auto;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .status-bar {
            background: #2c3e50;
            color: white;
            padding: 15px;
            border-radius: 0 0 15px 15px;
            font-size: 14px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .examples {
            margin-top: 20px;
        }

        .example-btn {
            background: #9b59b6;
            color: white;
            margin: 5px;
            padding: 8px 15px;
            font-size: 13px;
        }

        .example-btn:hover {
            background: #8e44ad;
        }

        .memory-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
        }

        .memory-table th, .memory-table td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }

        .memory-table th {
            background-color: #3498db;
            color: white;
        }

        .memory-table tr:nth-child(even) {
            background-color: #f2f2f2;
        }

        .memory-table tr:hover {
            background-color: #e8f4fc;
        }

        .icon {
            font-size: 16px;
        }

        .tabs {
            display: flex;
            margin-bottom: 15px;
            border-bottom: 2px solid #ddd;
        }

        .tab {
            padding: 10px 20px;
            cursor: pointer;
            border: none;
            background: none;
            font-weight: bold;
            color: #666;
            transition: all 0.3s ease;
        }

        .tab.active {
            color: #3498db;
            border-bottom: 3px solid #3498db;
            margin-bottom: -2px;
        }

        .tab:hover {
            color: #3498db;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üéì –£—á–µ–±–Ω–∞—è –í–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –ú–∞—à–∏–Ω–∞</h1>
            <div class="subtitle">–í–µ–±-–≤–µ—Ä—Å–∏—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä–∞ –£–í–ú —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π 4 –∫–æ–º–∞–Ω–¥</div>
        </header>

        <div class="main-content">
            <div class="panel">
                <div class="panel-header">üìù –†–µ–¥–∞–∫—Ç–æ—Ä –ø—Ä–æ–≥—Ä–∞–º–º—ã</div>

                <div class="tabs">
                    <button class="tab active" onclick="switchTab('editor')">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–æ—Ä</button>
                    <button class="tab" onclick="switchTab('examples')">üìö –ü—Ä–∏–º–µ—Ä—ã</button>
                    <button class="tab" onclick="switchTab('help')">‚ùì –ü–æ–º–æ—â—å</button>
                </div>

                <div id="editor-tab" class="tab-content active">
                    <textarea id="codeEditor" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø—Ä–æ–≥—Ä–∞–º–º—É –Ω–∞ —è–∑—ã–∫–µ –£–í–ú...
–ù–∞–ø—Ä–∏–º–µ—Ä:
LOAD_CONST 5
WRITE_MEM 100
SGN 100
WRITE_MEM 200"></textarea>

                    <div class="controls">
                        <button class="btn-run" onclick="runProgram()">
                            <span class="icon">‚ñ∂</span> –í—ã–ø–æ–ª–Ω–∏—Ç—å
                        </button>
                        <button class="btn-clear" onclick="clearEditor()">
                            <span class="icon">üóë</span> –û—á–∏—Å—Ç–∏—Ç—å
                        </button>
                        <button class="btn-example" onclick="loadExample('basic')">
                            <span class="icon">üìã</span> –ü—Ä–∏–º–µ—Ä
                        </button>
                    </div>

                    <div class="memory-range">
                        <span>–î–∏–∞–ø–∞–∑–æ–Ω –ø–∞–º—è—Ç–∏:</span>
                        <span>–æ—Ç</span>
                        <input type="number" id="startAddr" value="0" min="0" max="2047">
                        <span>–¥–æ</span>
                        <input type="number" id="endAddr" value="300" min="1" max="2047">
                    </div>
                </div>

                <div id="examples-tab" class="tab-content">
                    <div class="examples">
                        <h3>–ü—Ä–∏–º–µ—Ä—ã –ø—Ä–æ–≥—Ä–∞–º–º:</h3>
                        <button class="example-btn" onclick="loadExample('spec')">üìã –¢–µ—Å—Ç –∏–∑ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏</button>
                        <button class="example-btn" onclick="loadExample('vector')">üìã –í–µ–∫—Ç–æ—Ä SGN</button>
                        <button class="example-btn" onclick="loadExample('copy')">üìã –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∞—Å—Å–∏–≤–∞</button>
                        <button class="example-btn" onclick="loadExample('sgn')">üìã –¢–µ—Å—Ç SGN</button>
                        <button class="example-btn" onclick="loadExample('negative')">üìã –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ —á–∏—Å–ª–∞</button>
                    </div>
                </div>

                <div id="help-tab" class="tab-content">
                    <h3>üìñ –°–ø—Ä–∞–≤–∫–∞ –ø–æ —è–∑—ã–∫—É –£–í–ú</h3>
                    <p>–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è 4 –∫–æ–º–∞–Ω–¥—ã:</p>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li><code>LOAD_CONST &lt;–∑–Ω–∞—á–µ–Ω–∏–µ&gt;</code> - –ó–∞–≥—Ä—É–∑–∏—Ç—å –∫–æ–Ω—Å—Ç–∞–Ω—Ç—É –Ω–∞ —Å—Ç–µ–∫ (-16384..16383)</li>
                        <li><code>READ_MEM &lt;–∞–¥—Ä–µ—Å&gt;</code> - –ü—Ä–æ—á–∏—Ç–∞—Ç—å –∏–∑ –ø–∞–º—è—Ç–∏ –Ω–∞ —Å—Ç–µ–∫ (0-2047)</li>
                        <li><code>WRITE_MEM &lt;–∞–¥—Ä–µ—Å&gt;</code> - –ó–∞–ø–∏—Å–∞—Ç—å —Å –≤–µ—Ä—à–∏–Ω—ã —Å—Ç–µ–∫–∞ –≤ –ø–∞–º—è—Ç—å</li>
                        <li><code>SGN &lt;–∞–¥—Ä–µ—Å&gt;</code> - –í—ã—á–∏—Å–ª–∏—Ç—å –∑–Ω–∞–∫ —á–∏—Å–ª–∞ –∏–∑ –ø–∞–º—è—Ç–∏</li>
                    </ul>
                    <p>–ü—Ä–∏–º–µ—Ä –ø—Ä–æ–≥—Ä–∞–º–º—ã:</p>
                    <pre style="background: #f4f4f4; padding: 10px; border-radius: 5px; margin-top: 10px;">
LOAD_CONST 5
WRITE_MEM 100
LOAD_CONST -3
WRITE_MEM 101
SGN 100
WRITE_MEM 200
SGN 101
WRITE_MEM 201</pre>
                </div>
            </div>

            <div class="panel">
                <div class="panel-header">üìä –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∏ –ø–∞–º—è—Ç—å</div>

                <div class="tabs">
                    <button class="tab active" onclick="switchOutputTab('output')">üìù –í—ã–≤–æ–¥</button>
                    <button class="tab" onclick="switchOutputTab('memory')">üß† –ü–∞–º—è—Ç—å</button>
                    <button class="tab" onclick="switchOutputTab('stack')">üìö –°—Ç–µ–∫</button>
                </div>

                <div id="output-tab" class="tab-content active">
                    <div class="output" id="outputConsole">–ì–æ—Ç–æ–≤ –∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é...</div>
                </div>

                <div id="memory-tab" class="tab-content">
                    <div class="output" id="memoryDump">
                        <table class="memory-table" id="memoryTable">
                            <thead>
                                <tr>
                                    <th>–ê–¥—Ä–µ—Å</th>
                                    <th>–ó–Ω–∞—á–µ–Ω–∏–µ</th>
                                    <th>–û–ø–∏—Å–∞–Ω–∏–µ</th>
                                </tr>
                            </thead>
                            <tbody id="memoryTableBody">
                                <!-- –ó–¥–µ—Å—å –±—É–¥–µ—Ç —Ç–∞–±–ª–∏—Ü–∞ –ø–∞–º—è—Ç–∏ -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <div id="stack-tab" class="tab-content">
                    <div class="output" id="stackView">
                        <!-- –ó–¥–µ—Å—å –±—É–¥–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—Ç–µ–∫–∞ -->
                    </div>
                </div>
            </div>
        </div>

        <div class="status-bar">
            <div id="status">üü¢ –ì–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ</div>
            <div id="instructionCounter">–ö–æ–º–∞–Ω–¥: 0</div>
            <div id="stepCounter">–®–∞–≥–æ–≤: 0</div>
        </div>
    </div>

    <script>
        // ==================== –£–í–ú –ò–ù–¢–ï–†–ü–†–ï–¢–ê–¢–û–† –ù–ê JAVASCRIPT ====================

        class WebUVM {
            constructor() {
                this.dataMemory = new Array(2048).fill(0);
                this.stack = [];
                this.pc = 0;
                this.halted = false;
                this.output = "";
                this.steps = 0;
            }

            reset() {
                this.dataMemory.fill(0);
                this.stack = [];
                this.pc = 0;
                this.halted = false;
                this.output = "";
                this.steps = 0;
            }

            log(message) {
                this.output += message + "\n";
            }

            assemble(sourceCode) {
                const lines = sourceCode.split('\n');
                const instructions = [];

                for (let lineNum = 0; lineNum < lines.length; lineNum++) {
                    const line = lines[lineNum].trim();

                    // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –ø—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏ –∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
                    if (!line || line.startsWith(';')) {
                        continue;
                    }

                    // –£–±–∏—Ä–∞–µ–º –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≤ –∫–æ–Ω—Ü–µ —Å—Ç—Ä–æ–∫–∏
                    const codeLine = line.split(';')[0].trim();
                    const parts = codeLine.split(/\s+/);

                    if (parts.length !== 2) {
                        throw new Error(`–°—Ç—Ä–æ–∫–∞ ${lineNum + 1}: –ù–µ–≤–µ—Ä–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤`);
                    }

                    const mnemonic = parts[0].toUpperCase();
                    const operand = parseInt(parts[1]);

                    if (isNaN(operand)) {
                        throw new Error(`–°—Ç—Ä–æ–∫–∞ ${lineNum + 1}: –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç —á–∏—Å–ª–∞`);
                    }

                    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤
                    if (mnemonic === 'LOAD_CONST') {
                        if (operand < -16384 || operand > 16383) {
                            throw new Error(`–°—Ç—Ä–æ–∫–∞ ${lineNum + 1}: –ö–æ–Ω—Å—Ç–∞–Ω—Ç–∞ ${operand} –≤–Ω–µ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ -16384..16383`);
                        }
                    } else {
                        if (operand < 0 || operand > 2047) {
                            throw new Error(`–°—Ç—Ä–æ–∫–∞ ${lineNum + 1}: –ê–¥—Ä–µ—Å ${operand} –≤–Ω–µ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ 0-2047`);
                        }
                    }

                    // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –º–Ω–µ–º–æ–Ω–∏–∫—É –≤ –∫–æ–¥ –æ–ø–µ—Ä–∞—Ü–∏–∏
                    let opcode;
                    switch(mnemonic) {
                        case 'LOAD_CONST': opcode = 14; break;
                        case 'READ_MEM': opcode = 11; break;
                        case 'WRITE_MEM': opcode = 7; break;
                        case 'SGN': opcode = 4; break;
                        default:
                            throw new Error(`–°—Ç—Ä–æ–∫–∞ ${lineNum + 1}: –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞ ${mnemonic}`);
                    }

                    instructions.push({ opcode, operand, mnemonic });
                }

                return instructions;
            }

            execute(instructions) {
                this.log("=".repeat(50));
                this.log("–ó–ê–ü–£–°–ö –ò–ù–¢–ï–†–ü–†–ï–¢–ê–¢–û–†–ê –£–í–ú");
                this.log("=".repeat(50));

                for (let i = 0; i < instructions.length; i++) {
                    this.pc = i;
                    this.steps++;

                    const instr = instructions[i];
                    this.log(`[PC:${this.pc.toString().padStart(3, '0')}] ${instr.mnemonic} ${instr.operand.toString().padStart(4)} | –°—Ç–µ–∫: [${this.stack.join(', ')}]`);

                    try {
                        this.executeInstruction(instr);
                    } catch (error) {
                        this.log(`\n‚ùå –û–®–ò–ë–ö–ê –í–´–ü–û–õ–ù–ï–ù–ò–Ø: ${error.message}`);
                        return false;
                    }
                }

                this.log(`\n‚úÖ –ü—Ä–æ–≥—Ä–∞–º–º–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ`);
                this.log(`–í—ã–ø–æ–ª–Ω–µ–Ω–æ —à–∞–≥–æ–≤: ${this.steps}`);
                return true;
            }

            executeInstruction(instr) {
                const { opcode, operand, mnemonic } = instr;

                switch(opcode) {
                    case 14: // LOAD_CONST
                        this.stack.push(operand);
                        break;

                    case 11: // READ_MEM
                        if (operand < 0 || operand >= this.dataMemory.length) {
                            throw new Error(`–ê–¥—Ä–µ—Å –ø–∞–º—è—Ç–∏ ${operand} –≤–Ω–µ –¥–∏–∞–ø–∞–∑–æ–Ω–∞`);
                        }
                        this.stack.push(this.dataMemory[operand]);
                        break;

                    case 7: // WRITE_MEM
                        if (operand < 0 || operand >= this.dataMemory.length) {
                            throw new Error(`–ê–¥—Ä–µ—Å –ø–∞–º—è—Ç–∏ ${operand} –≤–Ω–µ –¥–∏–∞–ø–∞–∑–æ–Ω–∞`);
                        }
                        if (this.stack.length === 0) {
                            throw new Error("–°—Ç–µ–∫ –ø—É—Å—Ç –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–∏ WRITE_MEM");
                        }
                        const value = this.stack.pop();
                        this.dataMemory[operand] = value;
                        break;

                    case 4: // SGN
                        if (operand < 0 || operand >= this.dataMemory.length) {
                            throw new Error(`–ê–¥—Ä–µ—Å –ø–∞–º—è—Ç–∏ ${operand} –≤–Ω–µ –¥–∏–∞–ø–∞–∑–æ–Ω–∞`);
                        }
                        const memValue = this.dataMemory[operand];
                        let result;

                        if (memValue > 0) {
                            result = 1;
                        } else if (memValue < 0) {
                            result = -1;
                        } else {
                            result = 0;
                        }

                        this.stack.push(result);
                        break;
                }
            }

            getMemoryDump(start, end) {
                const dump = [];
                for (let addr = start; addr < Math.min(end, this.dataMemory.length); addr++) {
                    const value = this.dataMemory[addr];
                    let description = "";

                    if (value !== 0) {
                        if (100 <= addr && addr <= 109) {
                            description = `–≠–ª–µ–º–µ–Ω—Ç –º–∞—Å—Å–∏–≤–∞ A[${addr - 100}]`;
                        } else if (200 <= addr && addr <= 209) {
                            description = `–≠–ª–µ–º–µ–Ω—Ç –º–∞—Å—Å–∏–≤–∞ B[${addr - 200}]`;
                        } else if (addr >= 100 && addr < 200) {
                            description = "–ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ";
                        } else if (addr >= 200 && addr < 300) {
                            description = "–†–µ–∑—É–ª—å—Ç–∞—Ç—ã";
                        }
                    }

                    dump.push({ addr, value, description });
                }
                return dump;
            }
        }

        // ==================== –ò–ù–¢–ï–†–§–ï–ô–° ====================

        const uvm = new WebUVM();

        function switchTab(tabName) {
            // –°–∫—Ä—ã—Ç—å –≤—Å–µ –≤–∫–ª–∞–¥–∫–∏
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });

            // –£–±—Ä–∞—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —É –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });

            // –ü–æ–∫–∞–∑–∞—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—É—é –≤–∫–ª–∞–¥–∫—É
            document.getElementById(tabName + '-tab').classList.add('active');

            // –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –∫–Ω–æ–ø–∫—É
            event.target.classList.add('active');
        }

        function switchOutputTab(tabName) {
            // –°–∫—Ä—ã—Ç—å –≤—Å–µ –≤–∫–ª–∞–¥–∫–∏ –≤—ã–≤–æ–¥–∞
            document.querySelectorAll('#output-tab, #memory-tab, #stack-tab').forEach(tab => {
                tab.classList.remove('active');
            });

            // –£–±—Ä–∞—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —É –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫
            document.querySelectorAll('.main-content .right .tab').forEach(tab => {
                tab.classList.remove('active');
            });

            // –ü–æ–∫–∞–∑–∞—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—É—é –≤–∫–ª–∞–¥–∫—É
            document.getElementById(tabName + '-tab').classList.add('active');

            // –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –∫–Ω–æ–ø–∫—É
            event.target.classList.add('active');

            // –ï—Å–ª–∏ –≤—ã–±—Ä–∞–Ω–∞ –≤–∫–ª–∞–¥–∫–∞ –ø–∞–º—è—Ç–∏, –æ–±–Ω–æ–≤–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É
            if (tabName === 'memory') {
                updateMemoryTable();
            } else if (tabName === 'stack') {
                updateStackView();
            }
        }

        function runProgram() {
            const code = document.getElementById('codeEditor').value;
            const startAddr = parseInt(document.getElementById('startAddr').value) || 0;
            const endAddr = parseInt(document.getElementById('endAddr').value) || 300;

            // –°–±—Ä–æ—Å –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä–∞
            uvm.reset();

            // –û—á–∏—Å—Ç–∫–∞ –≤—ã–≤–æ–¥–∞
            document.getElementById('outputConsole').textContent = "";
            updateStatus("üîÑ –ê—Å—Å–µ–º–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ...");

            try {
                // –ê—Å—Å–µ–º–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ
                const instructions = uvm.assemble(code);
                updateInstructionCounter(instructions.length);

                updateStatus("‚ñ∂ –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ...");

                // –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
                const success = uvm.execute(instructions);

                if (success) {
                    updateStatus("‚úÖ –ü—Ä–æ–≥—Ä–∞–º–º–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞");

                    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–º–ø–∞ –ø–∞–º—è—Ç–∏
                    updateMemoryTable();
                    updateStackView();

                    // –í—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
                    document.getElementById('outputConsole').textContent = uvm.output;

                    // –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                    document.getElementById('stepCounter').textContent = `–®–∞–≥–æ–≤: ${uvm.steps}`;

                    // –í—ã–≤–µ—Å—Ç–∏ –¥–∞–º–ø –ø–∞–º—è—Ç–∏ –≤ –∫–æ–Ω—Å–æ–ª—å
                    const dump = uvm.getMemoryDump(startAddr, endAddr);
                    const nonZero = dump.filter(item => item.value !== 0).length;

                    uvm.log(`\nüìä –î–∞–º–ø –ø–∞–º—è—Ç–∏ (${startAddr}-${endAddr-1}):`);
                    uvm.log(`–ù–µ–Ω—É–ª–µ–≤—ã—Ö —è—á–µ–µ–∫: ${nonZero}`);

                    document.getElementById('outputConsole').textContent = uvm.output;
                } else {
                    updateStatus("‚ùå –û—à–∏–±–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è");
                }

            } catch (error) {
                document.getElementById('outputConsole').textContent = `‚ùå –û—à–∏–±–∫–∞ –∞—Å—Å–µ–º–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è:\n${error.message}`;
                updateStatus("‚ùå –û—à–∏–±–∫–∞ –∞—Å—Å–µ–º–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è");
                updateInstructionCounter(0);
                updateStepCounter(0);
            }
        }

        function clearEditor() {
            document.getElementById('codeEditor').value = "";
            document.getElementById('outputConsole').textContent = "–ì–æ—Ç–æ–≤ –∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é...";
            document.getElementById('memoryTableBody').innerHTML = "";
            document.getElementById('stackView').innerHTML = "";
            updateStatus("üü¢ –ì–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ");
            updateInstructionCounter(0);
            updateStepCounter(0);
        }

        function loadExample(exampleName) {
            let code = "";

            switch(exampleName) {
                case 'basic':
                    code = `; –ü—Ä–æ—Å—Ç–µ–π—à–∏–π –ø—Ä–∏–º–µ—Ä
LOAD_CONST 5
WRITE_MEM 100
SGN 100
WRITE_MEM 200`;
                    break;

                case 'spec':
                    code = `; –¢–µ—Å—Ç –∏–∑ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ –£–í–ú
LOAD_CONST 831
READ_MEM 97
WRITE_MEM 291
SGN 158`;
                    break;

                case 'vector':
                    code = `; –í–µ–∫—Ç–æ—Ä SGN (10 —ç–ª–µ–º–µ–Ω—Ç–æ–≤)
; –ò—Å—Ö–æ–¥–Ω—ã–π –≤–µ–∫—Ç–æ—Ä
LOAD_CONST 5
WRITE_MEM 100
LOAD_CONST -2
WRITE_MEM 101
LOAD_CONST 0
WRITE_MEM 102
LOAD_CONST 100
WRITE_MEM 103
LOAD_CONST -50
WRITE_MEM 104
LOAD_CONST 1
WRITE_MEM 105
LOAD_CONST -1
WRITE_MEM 106
LOAD_CONST 999
WRITE_MEM 107
LOAD_CONST -999
WRITE_MEM 108
LOAD_CONST 0
WRITE_MEM 109

; –†–µ–∑—É–ª—å—Ç–∞—Ç—ã SGN
SGN 100
WRITE_MEM 200
SGN 101
WRITE_MEM 201
SGN 102
WRITE_MEM 202
SGN 103
WRITE_MEM 203
SGN 104
WRITE_MEM 204
SGN 105
WRITE_MEM 205
SGN 106
WRITE_MEM 206
SGN 107
WRITE_MEM 207
SGN 108
WRITE_MEM 208
SGN 109
WRITE_MEM 209`;
                    break;

                case 'copy':
                    code = `; –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∞—Å—Å–∏–≤–∞
LOAD_CONST 10
WRITE_MEM 110
LOAD_CONST 20
WRITE_MEM 111
LOAD_CONST 30
WRITE_MEM 112

READ_MEM 110
WRITE_MEM 210
READ_MEM 111
WRITE_MEM 211
READ_MEM 112
WRITE_MEM 212`;
                    break;

                case 'sgn':
                    code = `; –¢–µ—Å—Ç —Ñ—É–Ω–∫—Ü–∏–∏ SGN
LOAD_CONST 5
WRITE_MEM 120
LOAD_CONST 0
WRITE_MEM 121
LOAD_CONST -3
WRITE_MEM 122

SGN 120
WRITE_MEM 220
SGN 121
WRITE_MEM 221
SGN 122
WRITE_MEM 222`;
                    break;

                case 'negative':
                    code = `; –¢–µ—Å—Ç –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö —á–∏—Å–µ–ª
LOAD_CONST -16384
WRITE_MEM 130
LOAD_CONST 16383
WRITE_MEM 131
LOAD_CONST -100
WRITE_MEM 132

SGN 130
WRITE_MEM 230
SGN 131
WRITE_MEM 231
SGN 132
WRITE_MEM 232`;
                    break;
            }

            document.getElementById('codeEditor').value = code;
            switchTab('editor');
        }

        function updateMemoryTable() {
            const startAddr = parseInt(document.getElementById('startAddr').value) || 0;
            const endAddr = parseInt(document.getElementById('endAddr').value) || 300;
            const dump = uvm.getMemoryDump(startAddr, endAddr);

            const tableBody = document.getElementById('memoryTableBody');
            tableBody.innerHTML = "";

            dump.forEach(item => {
                const row = document.createElement('tr');

                const addrCell = document.createElement('td');
                addrCell.textContent = item.addr;

                const valueCell = document.createElement('td');
                valueCell.textContent = item.value;
                if (item.value !== 0) {
                    valueCell.style.fontWeight = 'bold';
                    valueCell.style.color = '#e74c3c';
                }

                const descCell = document.createElement('td');
                descCell.textContent = item.description;

                row.appendChild(addrCell);
                row.appendChild(valueCell);
                row.appendChild(descCell);
                tableBody.appendChild(row);
            });
        }

        function updateStackView() {
            const stackView = document.getElementById('stackView');
            stackView.innerHTML = "";

            if (uvm.stack.length === 0) {
                stackView.textContent = "–°—Ç–µ–∫ –ø—É—Å—Ç";
                return;
            }

            const stackDiv = document.createElement('div');
            stackDiv.style.display = 'flex';
            stackDiv.style.flexDirection = 'column-reverse';
            stackDiv.style.gap = '5px';
            stackDiv.style.alignItems = 'center';

            // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —Å—Ç–µ–∫ —Å–Ω–∏–∑—É –≤–≤–µ—Ä—Ö
            for (let i = 0; i < uvm.stack.length; i++) {
                const itemDiv = document.createElement('div');
                itemDiv.style.background = i === uvm.stack.length - 1 ? '#2ecc71' : '#3498db';
                itemDiv.style.color = 'white';
                itemDiv.style.padding = '10px 20px';
                itemDiv.style.borderRadius = '5px';
                itemDiv.style.minWidth = '60px';
                itemDiv.style.textAlign = 'center';
                itemDiv.style.fontWeight = 'bold';
                itemDiv.textContent = uvm.stack[i];

                if (i === uvm.stack.length - 1) {
                    itemDiv.innerHTML += '<br><small>(–≤–µ—Ä—à–∏–Ω–∞)</small>';
                }

                stackDiv.appendChild(itemDiv);
            }

            stackView.appendChild(stackDiv);
            stackView.innerHTML += `<div style="margin-top: 10px; color: #666;">–í—Å–µ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤: ${uvm.stack.length}</div>`;
        }

        function updateStatus(message) {
            document.getElementById('status').textContent = message;
        }

        function updateInstructionCounter(count) {
            document.getElementById('instructionCounter').textContent = `–ö–æ–º–∞–Ω–¥: ${count}`;
        }

        function updateStepCounter(steps) {
            document.getElementById('stepCounter').textContent = `–®–∞–≥–æ–≤: ${steps}`;
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ—Å—Ç–æ–≥–æ –ø—Ä–∏–º–µ—Ä–∞ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏
        window.onload = function() {
            loadExample('basic');
        };
    </script>
</body>

</html>
